kubectl create -f - <<-EOF
apiVersion: v1
kind: Pod
metadata:
  name: prometheus-pod
  namespace: calico-monitoring
  labels:
    app: prometheus-pod
    role: monitoring
spec:
  serviceAccountName: calico-prometheus-user
  containers:
  - name: prometheus-pod
    image: prom/prometheus
    resources:
      limits:
        memory: "128Mi"
        cpu: "500m"
    volumeMounts:
    - name: config-volume
      mountPath: /etc/prometheus/prometheus.yml
      subPath: prometheus.yml
    ports:
    - containerPort: 9090
  volumes:
  - name: config-volume
    configMap:
      name: prometheus-config
EOF

{__name__=~".+"}
go_gc_duration_seconds{instance="172.31.38.151:9100", job="prometheus-node-exporter", quantile="0.25"}
rate(go_gc_duration_seconds{instance="172.31.38.151:9100", job="prometheus-node-exporter", quantile="0.25"}[5m])

rate(go_memstats_stack_sys_bytes{instance="192.168.171.4:9094", job="kube_controllers_metrics"}[5m])


apiVersion: v1
kind: Service
metadata:
  labels:
    app: prometheus-pod
    role: monitoring
  name: prometheus
  namespace: calico-monitoring
spec:
  ports:
  - nodePort: 30090
    port: 9090
    protocol: TCP
    targetPort: 9090
  selector:
    app: prometheus-pod
    role: monitoring
  type: NodePort

  http://prometheus-pod.calico-monitoring.svc:9090